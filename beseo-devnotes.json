{
  "meta": {
    "project_name": "BE Schema Engine",
    "alias": "BE SEO Engine",
    "author": "William Evans, PhD",
    "description": "Central, conservative schema + social meta for WordPress (Elementor-first), with strong safety, Elementor integration, debug tooling, and a predictable architecture.",
    "version": "1.3.30",
    "repo_root": "beseo/"
  },
  "workflows": {
    "after_push": {
      "must_read_commit_log": true,
      "description": "After the user confirms a push, review the local BE_SEO-Commit_Log.js to identify changed files."
    },
    "debug": {
      "schema_debug_requires_wp_debug": true,
      "social_debug_requires_wp_debug": true,
      "description": "Both schema and social debug logging require WP_DEBUG plus the plugin-level debug or BE_SCHEMA_DEBUG flag.",
      "collector_notes": "be_schema_debug_collect now stores emitted graphs and logs BE_SCHEMA_DEBUG_GRAPH payloads when debug is enabled."
    },
    "versioning": {
      "description": "Project is called BESEO. When adding new features, increment the minor version. For other source changes, increment the patch version."
    },
    "pre_commit": {
      "hook_path": ".githooks/pre-commit",
      "enable_command": "git config core.hooksPath .githooks",
      "behavior": "On commit, auto-bumps the version (BESEO_BUMP=minor|patch; default patch), updates beseo.php and BE_SEO-Dev_Notes.json, and prepends a changelog entry listing staged files.",
      "changelog": "CHANGELOG.md is auto-maintained by the pre-commit hook.",
      "description_logic": "Changelog summary line is prefixed with 'Summary:' and capitalizes the first letter of the summary text (BESEO_CHANGELOG_DESC overrides). Sections (Added/Changed/Fixed/Removed/Security/Upgrade Notes) render only when populated, and the staged file list appears under Files only. Header uses an HTML <hr /> divider and the Overview changelog renderer converts --- or <hr> lines into a styled horizontal rule.",
      "runtime": "Requires python3 (preferred) or python in PATH; hook exits if neither is available."
    },
    "prepare_commit_msg": {
      "hook_path": ".githooks/prepare-commit-msg",
      "behavior": "If the commit message is empty, auto-fills a human-centered default. Override with BESEO_COMMIT_MSG env var or by typing your own message.",
      "default_message": "BESEO: streamline overview UX and tooling"
    }
  },
  "files": [
    {
      "path": "beseo.php",
      "group": "bootstrap",
      "role": "Main plugin bootstrap; defines constants, loads includes, registers core hooks."
    },
    {
      "path": "includes/admin/admin-menu.php",
      "group": "admin",
      "role": "Registers top-level BE SEO admin menu and submenus (Overview default, Schema, Social Media, Tools)."
    },
    {
      "path": "assets/images/admin/be_seo-landing_image.webp",
      "group": "assets",
      "role": "Hero background image for the Overview admin page."
    },
    {
      "path": "CHANGELOG.md",
      "group": "assets",
      "role": "Packaged changelog copy used for the Overview hero preview."
    },
    {
      "path": "includes/admin/page-overview.php",
      "group": "admin",
      "role": "Overview landing page with hero background image (cover), row-based hero content (title, version, GitHub and Bill's site links) plus inline rendered changelog preview."
    },
    {
      "path": "includes/admin/page-dashboard.php",
      "group": "admin",
      "role": "Dashboard/overview page for the BE SEO plugin (if used)."
    },
    {
      "path": "includes/admin/page-schema.php",
      "group": "admin",
      "role": "Schema submenu UI: Settings + Website tabs; Website tab has vertical Global/Person/Organisation/Publisher sections."
    },
    {
      "path": "includes/admin/page-social-media.php",
      "group": "admin",
      "role": "Social Media submenu UI: Settings/Facebook/Twitter tabs and associated options."
    },
    {
      "path": "includes/admin/page-tools.php",
      "group": "admin",
      "role": "Tools submenu UI (future home for validators, snapshots, etc.)."
    },
    {
      "path": "includes/engine/core-breadcrumbs.php",
      "group": "engine",
      "role": "Emits BreadcrumbList schema for non-front pages; always two levels: root + current."
    },
    {
      "path": "includes/engine/core-debug.php",
      "group": "engine",
      "role": "Schema debug collector and shutdown logger; writes BE_SCHEMA_DEBUG_GRAPH payloads to error_log when enabled."
    },
    {
      "path": "includes/engine/core-elementor.php",
      "group": "engine",
      "role": "Elementor integration: page-level schema controls, widget-level enable switch, and safe, limited widget schema output."
    },
    {
      "path": "includes/engine/core-helpers.php",
      "group": "engine",
      "role": "Shared helper functions for text normalization, image normalization, per-page disable checks, and post-type eligibility."
    },
    {
      "path": "includes/engine/core-posts.php",
      "group": "engine",
      "role": "BlogPosting schema for eligible single posts, including dates, description, mainEntityOfPage, author, publisher, and image."
    },
    {
      "path": "includes/engine/core-site-entities.php",
      "group": "engine",
      "role": "Builds site-level entities: Person, Organisation, WebSite, Publisher, and shared logo/person image nodes."
    },
    {
      "path": "includes/engine/core-social.php",
      "group": "engine",
      "role": "Outputs OpenGraph and Twitter Card meta tags based on Social Media settings and page context."
    },
    {
      "path": "includes/engine/core-special-pages.php",
      "group": "engine",
      "role": "Page-level schema for homepage and special pages (Contact, About, Privacy, Accessibility) with Elementor page-type integration."
    }
  ],
  "schema_design": {
    "site_entities": {
      "person": {
        "enabled_via_admin": true,
        "default_name_source": "site_name",
        "image_sources": [
          "person_profile_image",
          "logo"
        ],
        "honorific_fields": [
          "honorificPrefix",
          "honorificSuffix"
        ],
        "sameAs_source": "person_textarea_only"
      },
      "organisation": {
        "enabled_via_admin": true,
        "logo_source": "global_logo",
        "sameAs_source": "be_schema_sameas_urls_filter",
        "fields": [
          "name",
          "legalName",
          "url"
        ]
      },
      "website": {
        "always_present": true,
        "about_preference_order": [
          "organisation",
          "person"
        ],
        "logo_source": "global_logo",
        "publisher_resolution_order": [
          "custom_publisher_org",
          "organisation",
          "person"
        ]
      },
      "publisher": {
        "optional": true,
        "can_be_custom_org": true,
        "custom_logo_source": "publisher_logo",
        "fallback_to_site_entities": true
      }
    },
    "page_schema": {
      "homepage": {
        "graph_nodes": [
          "Person",
          "Organisation",
          "WebSite",
          "WebPage"
        ],
        "webpage_links": {
          "isPartOf": "#website",
          "about": [
            "#organisation",
            "#person"
          ],
          "primaryImageOfPage": [
            "featured_image",
            "global_logo"
          ]
        }
      },
      "special_pages": {
        "types": {
          "contact": "ContactPage",
          "about": "AboutPage",
          "privacy-policy": "PrivacyPolicy",
          "accessibility-statement": "WebPage"
        },
        "description_strategy": "elementor_override_or_default_string",
        "respects": [
          "global_disable",
          "per_page_disable",
          "elementor_page_enable"
        ]
      }
    },
    "blogposting": {
      "eligibility": {
        "is_singular_post": true,
        "post_type_filter": "be_schema_is_singular_eligible",
        "per_page_not_disabled": true
      },
      "fields": {
        "id_suffix": "#article",
        "mainEntityOfPage": "WebPage node with @id = post permalink",
        "description_sources": [
          "excerpt",
          "normalized_content_snippet"
        ],
        "dates": [
          "datePublished",
          "dateModified"
        ],
        "author": "Person#person",
        "publisher": "resolved_publisher_entity",
        "image_sources": [
          "featured_image",
          "be_schema_get_default_image_url"
        ]
      }
    },
    "breadcrumbs": {
      "always_two_steps": true,
      "steps": [
        "site_root",
        "current_page_or_archive"
      ],
      "skips": [
        "front_page",
        "schema_disabled_pages"
      ],
      "url_cleaning": [
        "utm_*",
        "gclid",
        "fbclid"
      ]
    },
    "elementor": {
      "page_level": {
        "enable_control": "be_schema_enable_page",
        "enable_yes_value": "yes",
        "default_disabled_if_missing": true,
        "page_type_control": "be_schema_page_type"
      },
      "widget_level": {
        "enable_control": "be_schema_enable_widget",
        "only_yes_emits_schema": true,
        "schema_only_for_curated_widgets": true
      }
    }
  },
  "social_design": {
    "purpose": "Social Media module is only for OpenGraph and Twitter Cards; it does not emit JSON-LD or canonical tags.",
    "data_flow": {
      "admin_settings_option": "be_schema_social_settings",
      "engine_file": "includes/engine/core-social.php"
    },
    "url_behavior": {
      "primary_source": "wp_get_canonical_url_or_permalink",
      "cleaning": [
        "utm_*",
        "gclid",
        "fbclid",
        "fragments"
      ]
    },
    "title_behavior": {
      "source": "wp_get_document_title"
    },
    "description_behavior": {
      "singular_sources": [
        "excerpt",
        "post_content"
      ],
      "non_singular_source": "site_tagline",
      "normalization_helper": "be_schema_normalize_text"
    },
    "image_behavior": {
      "og_fallback_order": [
        "featured_image",
        "facebook_default_image",
        "global_default_image"
      ],
      "twitter_fallback_order": [
        "featured_image",
        "twitter_default_image",
        "global_default_image"
      ]
    },
    "og": {
      "type_rules": {
        "post": "article",
        "default": "website"
      },
      "fields": [
        "og:title",
        "og:description",
        "og:type",
        "og:url",
        "og:site_name",
        "og:image"
      ],
      "article_extras": [
        "article:published_time",
        "article:modified_time",
        "article:author"
      ],
      "optional_fields": [
        "fb:app_id"
      ]
    },
    "twitter": {
      "card_types": [
        "summary",
        "summary_large_image"
      ],
      "fields": [
        "twitter:card",
        "twitter:title",
        "twitter:description",
        "twitter:image"
      ],
      "handles": {
        "twitter_site": "site_handle_with_at",
        "twitter_creator": "creator_handle_with_at"
      }
    },
    "debug": {
      "log_prefix": "BE_SOCIAL_DEBUG",
      "snapshot_contents": [
        "url",
        "title",
        "description",
        "site_name",
        "og_enabled",
        "twitter_enabled",
        "og_type",
        "twitter_card_type",
        "resolved_images",
        "handles"
      ]
    }
  },
  "ui_notes": [
    "Schema > Website > Global: removed the panel title heading; section titles remain and now use a medium grey (#e1e4e8) background with dark text instead of black; global section padding increased to 15px; image row checkboxes centered with their fields; form-table left column now no-wraps and shrinks to fit content; Site Identity Mode uses a flex row with an ~380px checkbox column, 8px gap to the radios, and JS that bolds only the selected radio label.",
    "Schema > Website > Person: removed the panel title heading; honorific prefix and suffix are on one row with inline labels; panel now matches Global styling with bordered sections (Person Details, Person Links) using grey section headers and enclosed backgrounds.",
    "Schema > Website > Organisation/Publisher: removed panel titles; each now uses Global-style bordered sections with grey section headers enclosing enable toggles and their fields.",
    "Schema > Snapshots tab (Health/Individual/WordPress panels) now uses Global-style bordered sections with grey section headers wrapping the read-only tables.",
    "Social Media dashboard and Facebook/Twitter subtabs now use Global-style bordered sections with grey section headers around their settings/overview/status/content/tools blocks."
  ],
  "validation_notes": [
    "Schema settings: added URL validation (http/https) for Organisation URL, publisher URLs/policies, and numeric copyright year (4 digits), surfacing errors via settings_errors.",
    "Social settings: added URL validation (http/https) for Global/Facebook/Twitter images and Facebook Page URL, with admin error notices."
  ],
  "ux_notes": [
    "Schema Website entities (Person/Organisation/Publisher) now show inline status pills (ON/OFF) within their sections to surface current enable state.",
    "Schema Settings debug row now includes a read-only debug readiness box showing WP_DEBUG, admin debug toggle, and BE_SCHEMA_DEBUG constant state.",
    "Schema Snapshots > Health: added Issues column with badges for missing org/publisher name/logo and quick links to the relevant Website subtabs."
  ],
  "testing_notes": [
    "Manual test checklist in tests/README.md covering schema/social URL validation, copyright-year check, dry-run behaviour, and debug readiness pills. No automated test suite wired up yet."
  ],
  "safety_notes": [
    "Schema: added dry-run toggle (admin Settings) that prevents JSON-LD output while logging BE_SCHEMA_DRY_RUN events.",
    "Social: added dry-run toggle (Social Dashboard) that prevents OG/Twitter meta output while logging BE_SOCIAL_DRY_RUN events."
  ],
  "ux_notes_settings": [
    "Schema > Dashboard tab now uses Global-style bordered sections with grey headers (Engine, Debug & Safety) and a divider between debug and dry-run controls."
  ],
  "debug_notes": [
    "Schema Snapshots tab surfaces the last BE_SCHEMA_DEBUG_GRAPH payload (stored for 24h) with timestamp.",
    "Social Dashboard surfaces the last BE_SOCIAL_DEBUG snapshot (stored for 24h) with timestamp."
  ],
  "dev_workflow_notes": [
    "Home hero panel lists dev workflow reminders: pre-commit auto bump + auto message, use dry-run toggles for testing, check tests/README.md, keep beseo-devnotes.json updated.",
    "Changelog entries now include a generated Summary, a Description (neutral unless BESEO_CHANGELOG_DESC is set), and a Details list (from staged files or BESEO_COMMIT_MSG)."
  ]
}
