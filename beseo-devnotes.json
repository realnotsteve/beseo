{
  "meta": {
    "project_name": "BE Schema Engine",
    "alias": "BE SEO Engine",
    "author": "William Evans, PhD",
    "description": "Central, conservative schema + social meta for WordPress (Elementor-first), with strong safety, Elementor integration, debug tooling, and a predictable architecture.",
    "version": "3.0.10",
    "repo_root": "beseo/"
  },
  "workflows": {
    "after_push": {
      "description": "After the user confirms a push, review the changelog entry and staged files to verify what changed."
    },
    "debug": {
      "schema_debug_requires_wp_debug": true,
      "social_debug_requires_wp_debug": true,
      "description": "Both schema and social debug logging require WP_DEBUG plus the plugin-level debug or BE_SCHEMA_DEBUG flag.",
      "collector_notes": "be_schema_debug_collect logs BE_SCHEMA_DEBUG_GRAPH payloads when debug is enabled."
    },
    "versioning": {
      "description": "Project is called BESEO. When adding new features, increment the minor version. For other source changes, increment the patch version."
    },
    "pre_commit": {
      "hook_path": ".githooks/pre-commit",
      "enable_command": "git config core.hooksPath .githooks",
      "behavior": "On commit, auto-bumps the version (BESEO_BUMP=minor|patch; default patch), updates beseo.php and beseo-devnotes.json, and prepends a changelog entry listing staged files.",
      "changelog": "CHANGELOG.md is auto-maintained by the pre-commit hook.",
      "description_logic": "Changelog summary line is prefixed with 'Summary:' and capitalizes the first letter of the summary text (BESEO_CHANGELOG_DESC overrides). Sections (Added/Changed/Fixed/Removed/Security/Upgrade Notes) render only when populated, and the staged file list appears under Files only. Header uses an HTML <hr /> divider and the Overview changelog renderer converts --- or <hr> lines into a styled horizontal rule.",
      "runtime": "Requires python3 (preferred) or python in PATH; hook exits if neither is available."
    },
    "prepare_commit_msg": {
      "hook_path": ".githooks/prepare-commit-msg",
      "behavior": "If the commit message is empty, auto-fills a human-centered default. Override with BESEO_COMMIT_MSG env var or by typing your own message.",
      "default_message": "BESEO: update"
    }
  },
  "files": [
    {
      "path": "beseo.php",
      "group": "bootstrap",
      "role": "Main plugin bootstrap; defines constants, loads includes, registers core hooks."
    },
    {
      "path": "includes/admin/admin-menu.php",
      "group": "admin",
      "role": "Registers top-level BE SEO admin menu and submenus (Home default, Schema, Social Media, Sitemap, Analyser, Settings)."
    },
    {
      "path": "assets/images/admin/be_seo-landing_image.webp",
      "group": "assets",
      "role": "Hero background image for the Overview admin page."
    },
    {
      "path": "CHANGELOG.md",
      "group": "assets",
      "role": "Packaged changelog copy used for the Overview hero preview."
    },
    {
      "path": "includes/admin/page-overview.php",
      "group": "admin",
      "role": "Overview landing page with hero background image (cover), row-based hero content (title, version, GitHub and Bill's site links) plus inline rendered changelog preview."
    },
    {
      "path": "includes/admin/page-dashboard.php",
      "group": "admin",
      "role": "Dashboard/overview page for the BE SEO plugin (if used)."
    },
    {
      "path": "includes/admin/page-help-text.php",
      "group": "admin",
      "role": "Settings submenu Help Text UI: override list, add-new form, and validation helpers."
    },
    {
      "path": "includes/admin/page-schema.php",
      "group": "admin",
      "role": "Schema submenu UI: Dashboard/Website/Defaults/Options/Debug tabs; Website tab has vertical Global/Person/Organisation/Publisher sections."
    },
    {
      "path": "includes/admin/page-social-media.php",
      "group": "admin",
      "role": "Social Media submenu UI: Dashboard, Open Graph, and Platforms tabs with per-network subtabs (Facebook/Twitter/Instagram/TikTok/LinkedIn)."
    },
    {
      "path": "includes/admin/page-tools.php",
      "group": "admin",
      "role": "Analyser/Settings submenu UI (validators, tests, and Playfair capture hub)."
    },
    {
      "path": "includes/admin/playfair-admin.php",
      "group": "admin",
      "role": "AJAX handlers for Playfair health checks and captures."
    },
    {
      "path": "includes/cli/playfair-cli.php",
      "group": "cli",
      "role": "WP-CLI commands for Playfair capture diagnostics."
    },
    {
      "path": "includes/engine/core-breadcrumbs.php",
      "group": "engine",
      "role": "Emits BreadcrumbList schema for non-front pages; always two levels: root + current."
    },
    {
      "path": "includes/engine/core-debug.php",
      "group": "engine",
      "role": "Schema debug collector and shutdown logger; writes BE_SCHEMA_DEBUG_GRAPH payloads to error_log when enabled."
    },
    {
      "path": "includes/engine/core-elementor.php",
      "group": "engine",
      "role": "Elementor integration: page-level schema controls, widget-level enable switch, and safe, limited widget schema output."
    },
    {
      "path": "includes/engine/core-helpers.php",
      "group": "engine",
      "role": "Shared helper functions for text normalization, image normalization, per-page disable checks, and post-type eligibility."
    },
    {
      "path": "includes/engine/core-playfair.php",
      "group": "engine",
      "role": "Playfair capture client (local/remote) with JSON parsing and SSRF validation."
    },
    {
      "path": "includes/engine/core-posts.php",
      "group": "engine",
      "role": "BlogPosting schema for eligible single posts, including dates, description, mainEntityOfPage, author, publisher, and image."
    },
    {
      "path": "includes/engine/core-site-entities.php",
      "group": "engine",
      "role": "Builds site-level entities: Person, Organisation, WebSite, Publisher, and shared logo/person image nodes."
    },
    {
      "path": "includes/engine/core-social.php",
      "group": "engine",
      "role": "Outputs OpenGraph and Twitter Card meta tags based on Social Media settings and page context."
    },
    {
      "path": "includes/engine/core-special-pages.php",
      "group": "engine",
      "role": "Page-level schema for homepage and special pages (Contact, About, Privacy, Accessibility) with Elementor page-type integration."
    }
  ],
  "schema_design": {
    "site_entities": {
      "person": {
        "enabled_via_admin": true,
        "default_name_source": "site_name",
        "image_sources": [
          "person_profile_image",
          "logo"
        ],
        "honorific_fields": [
          "honorificPrefix",
          "honorificSuffix"
        ],
        "sameAs_source": "person_textarea_only"
      },
      "organisation": {
        "enabled_via_admin": true,
        "logo_source": "global_logo",
        "sameAs_source": "be_schema_sameas_urls_filter",
        "fields": [
          "name",
          "legalName",
          "url"
        ]
      },
      "website": {
        "always_present": true,
        "about_preference_order": [
          "organisation",
          "person"
        ],
        "logo_source": "global_logo",
        "publisher_resolution_order": [
          "custom_publisher_org",
          "organisation",
          "person"
        ]
      },
      "publisher": {
        "optional": true,
        "can_be_custom_org": true,
        "custom_logo_source": "publisher_logo",
        "fallback_to_site_entities": true
      }
    },
    "page_schema": {
      "homepage": {
        "graph_nodes": [
          "Person",
          "Organisation",
          "WebSite",
          "WebPage"
        ],
        "webpage_links": {
          "isPartOf": "#website",
          "about": [
            "#organisation",
            "#person"
          ],
          "primaryImageOfPage": [
            "featured_image",
            "global_logo"
          ]
        }
      },
      "special_pages": {
        "types": {
          "contact": "ContactPage",
          "about": "AboutPage",
          "privacy-policy": "PrivacyPolicy",
          "accessibility-statement": "WebPage"
        },
        "description_strategy": "elementor_override_or_default_string",
        "respects": [
          "global_disable",
          "per_page_disable",
          "elementor_page_enable"
        ]
      }
    },
    "blogposting": {
      "eligibility": {
        "is_singular_post": true,
        "post_type_filter": "be_schema_is_singular_eligible",
        "per_page_not_disabled": true
      },
      "fields": {
        "id_suffix": "#article",
        "mainEntityOfPage": "WebPage node with @id = post permalink",
        "description_sources": [
          "excerpt",
          "normalized_content_snippet"
        ],
        "dates": [
          "datePublished",
          "dateModified"
        ],
        "author": "Person#person",
        "publisher": "resolved_publisher_entity",
        "image_sources": [
          "featured_image",
          "be_schema_get_default_image_url"
        ]
      }
    },
    "breadcrumbs": {
      "always_two_steps": true,
      "steps": [
        "site_root",
        "current_page_or_archive"
      ],
      "skips": [
        "front_page",
        "schema_disabled_pages"
      ],
      "url_cleaning": [
        "utm_*",
        "gclid",
        "fbclid"
      ]
    },
    "elementor": {
      "page_level": {
        "enable_control": "be_schema_enable_page",
        "enable_yes_value": "yes",
        "default_disabled_if_missing": true,
        "page_type_control": "be_schema_page_type"
      },
      "widget_level": {
        "enable_control": "be_schema_enable_widget",
        "only_yes_emits_schema": true,
        "schema_only_for_curated_widgets": true
      }
    }
  },
  "social_design": {
    "purpose": "Social Media module is only for OpenGraph and Twitter Cards; it does not emit JSON-LD or canonical tags.",
    "data_flow": {
      "admin_settings_option": "be_schema_social_settings",
      "engine_file": "includes/engine/core-social.php"
    },
    "url_behavior": {
      "primary_source": "wp_get_canonical_url_or_permalink",
      "cleaning": [
        "utm_*",
        "gclid",
        "fbclid",
        "fragments"
      ]
    },
    "title_behavior": {
      "source": "wp_get_document_title"
    },
    "description_behavior": {
      "singular_sources": [
        "excerpt",
        "post_content"
      ],
      "non_singular_source": "site_tagline",
      "normalization_helper": "be_schema_normalize_text"
    },
    "image_behavior": {
      "og_fallback_order": [
        "featured_image",
        "facebook_default_image",
        "global_default_image"
      ],
      "twitter_fallback_order": [
        "featured_image",
        "twitter_default_image",
        "global_default_image"
      ]
    },
    "og": {
      "type_rules": {
        "post": "article",
        "default": "website"
      },
      "fields": [
        "og:title",
        "og:description",
        "og:type",
        "og:url",
        "og:site_name",
        "og:image"
      ],
      "article_extras": [
        "article:published_time",
        "article:modified_time",
        "article:author"
      ],
      "optional_fields": [
        "fb:app_id"
      ]
    },
    "twitter": {
      "card_types": [
        "summary",
        "summary_large_image"
      ],
      "fields": [
        "twitter:card",
        "twitter:title",
        "twitter:description",
        "twitter:image"
      ],
      "handles": {
        "twitter_site": "site_handle_with_at",
        "twitter_creator": "creator_handle_with_at"
      }
    },
    "debug": {
      "log_prefix": "BE_SOCIAL_DEBUG",
      "snapshot_contents": [
        "url",
        "title",
        "description",
        "site_name",
        "og_enabled",
        "twitter_enabled",
        "og_type",
        "twitter_card_type",
        "resolved_images",
        "handles",
        "automatic",
        "final"
      ]
    }
  },
  "playfair_notes": {
    "source_of_truth": "Playfair integration guide 2025-12-23 (pasted by Bill Evans) supersedes earlier devnotes.",
    "endpoints": {
      "remote_base_url_default": "https://playfair.belexes.com",
      "local_base_url_default": "http://127.0.0.1:3719",
      "health_path": "/health",
      "capture_path": "/capture"
    },
    "auth": {
      "header": "X-Playfair-Token",
      "token_storage": "wp_options (hidden in UI)",
      "local_auth_optional": true
    },
    "capture_request": {
      "required": [
        "url"
      ],
      "optional": [
        "waitMs",
        "profile",
        "includeHtml",
        "includeLogs",
        "locale",
        "timezoneId"
      ],
      "profiles": [
        "desktop_chromium",
        "mobile_chromium",
        "webkit"
      ],
      "defaults": {
        "waitMs": 1500,
        "includeHtml": false,
        "includeLogs": true
      }
    },
    "capture_response": {
      "success_shape": [
        "ok",
        "url",
        "profile",
        "options",
        "opengraph",
        "schema",
        "logs",
        "html (optional)"
      ],
      "schema_formats": [
        "json-ld strings",
        "objects with raw/parsed"
      ],
      "opengraph_formats": [
        "arrays of {key, content}"
      ],
      "logs_keys": [
        "console",
        "pageErrors",
        "requestFailed"
      ]
    },
    "modes": {
      "values": [
        "auto",
        "remote",
        "local"
      ],
      "auto_behavior": "capture auto routes private/local targets to local, otherwise remote; health checks try remote first then local fallback"
    },
    "security": {
      "ssrf_guard": "block private/local targets unless developer mode enabled",
      "do_not_log_token": true
    },
    "admin_tools": {
      "settings_fields": [
        "remote_base_url",
        "remote_token",
        "local_base_url",
        "mode",
        "timeout_seconds",
        "default_profile",
        "default_wait_ms",
        "default_locale",
        "default_timezone",
        "allow_private_targets"
      ],
      "tools_actions": [
        "Health Check",
        "Run Test",
        "Run Capture"
      ],
      "visibility": "admin only"
    }
  },
  "ui_notes": [
    "Schema > Website > Global: panel title heading is absent; section titles use a medium grey (#e1e4e8) background with dark text; global section padding is 15px; image row checkboxes are centered with their fields; form-table left column no-wraps and shrinks to fit content; Site Identity Mode uses a flex row with an ~380px checkbox column, 8px gap to the radios, and JS that bolds only the selected radio label.",
    "Schema > Website > Person: panel title heading is absent; honorific prefix and suffix are on one row with inline labels; panel matches Global styling with bordered sections (Person Details, Person Links) using grey section headers and enclosed backgrounds.",
    "Schema > Website > Organisation/Publisher: panel titles are absent; each uses Global-style bordered sections with grey section headers enclosing enable toggles and their fields. Organisation optional fields (Legal Name, Organisation URL) use a dropdown + add/remove pattern like Person.",
    "Schema > Dashboard uses Global-style bordered sections with grey section headers inside Operation, Health Check, and Individual Schema panels.",
    "Social Media dashboard and Facebook/Twitter subtabs use Global-style bordered sections with grey section headers around their settings/overview/status/content/tools blocks. Facebook/Twitter Cards panels expose optional fields via dropdown + add/remove (Page URL/App ID/notes; @handles/image alt).",
    "Social Media tabs include Dashboard, Open Graph, and Platforms.",
    "Platforms tab hosts Facebook/Twitter/Instagram/TikTok/LinkedIn subtabs (placeholders for Instagram/TikTok/LinkedIn).",
    "Analyser shared selector includes Playfair Health Check and Run Test actions."
  ],
  "validation_notes": [
    "Schema settings: added URL validation (http/https) for Organisation URL, surfacing errors via settings_errors.",
    "Social settings: added URL validation (http/https) for Global/Facebook/Twitter images and Facebook Page URL, with admin error notices."
  ],
  "ux_notes": [
    "Schema Website entities (Person/Organisation/Publisher) show inline status pills (ON/OFF) within their sections to surface current enable state.",
    "Schema > Debug shows the debug toggle and a WP_DEBUG warning when WordPress debug is off.",
    "Schema > Dashboard > Health Check includes an Issues column with badges for missing org/publisher name/logo and quick links to the relevant Website subtabs.",
    "Schema > Website > Publisher mirrors the Person optional-properties picker: Entity and Dedicated sections use a dropdown + add/remove buttons to reveal only the publisher fields you want to output.",
    "Publisher Dedicated optional controls (dropdown, add/remove, inputs) are only enabled when both WebSite.publisher and Dedicated Publisher toggles are on.",
    "Publisher panel shows a secondary pill indicating publisher type: Reference (green) when enabled without dedicated, Dedicated (green) when dedicated is on, and None (red) when WebSite.publisher is disabled.",
    "Schema > Website > Person optional dropdown includes Person URL, Alumni Of, Job Title, and Affiliation fields (add/remove on demand); values feed the Person node.",
    "Optional-property dropdowns gray out single-instance fields after they are added (e.g., Person URL, Org Legal Name/URL, publisher policies, Facebook page/app ID, Twitter handle, WebSite featured images).",
    "WebSite Featured Images show inline status pills: Undefined (grey) initially/after clear, Verified (green) when selected dimensions match recommendations, Resolution (red) when dimensions differ (16:9 = 1920x1080, 4:3 = 1600x1200, 1:1 = 1200x1200, 3:4 = 1200x1600, 9:16 = 1080x1920).",
    "WebSite Featured Images remove buttons sit inline to the left of their labels (no overlap with the text).",
    "Site Logo uses the same aspect-ratio image picker as WebSite images, with per-aspect status pills and recommended dimensions (no fixed 512 PNG requirement).",
    "Person optional fields that can be multi-valued (honorific prefixes/suffixes, alumni, job titles, affiliations) support repeatable inputs via the dropdown + add behavior; Person URL remains singleton.",
    "Optional dropdown add logic resets repeatable fields when first shown so selecting a multi-value property surfaces one input instead of duplicating blanks.",
    "Multi-value optional fields normalize empty repeatables after adding from the dropdown to prevent duplicate blank rows, including when shown automatically.",
    "When a repeatable optional field is added from the dropdown for the first time, it force-resets to a single blank row to avoid double inputs.",
    "Schema > Website > Person uses a dedicated Image(s) section (outside Person Details) with the optional aspect-ratio picker, enable toggles, and status pills; Profile Image is not a single fixed 1200x1200 WebP field.",
    "Removed the left-side border on the Person Image(s) section so it aligns with other Person panels.",
    "Schema > Website > Publisher > Dedicated separates Custom Publisher Logo into its own Image(s) dropdown at the same level as other rows; the primary Optional Properties dropdown is limited to name and URL, and the image dropdown offers all WebSite Featured Image aspect options.",
    "Schema > Website > Person > Image(s) uses a dropdown to add any of the WebSite Featured Image aspect options (16:9, 4:3, 1:1, 3:4, 9:16) with enable toggles, previews, and dimension guidance.",
    "Schema > Website > Global > Site Logo uses a dropdown to add WebSite Featured Image aspect options (16:9, 4:3, 1:1, 3:4, 9:16) with enable toggles, previews, and recommended dimensions; the selected logo feeds Organisation and WebSite.",
    "Social Media submenu remains; Open Graph is a tab inside Social Media.",
    "Open Graph global fallback image helper text includes recommended specs: 1.91:1 aspect ratio, 1200x630 resolution, JPEG or PNG formats, plus an Alternate Aspect Ratios dropdown with common sizes and add/remove controls with left-aligned minus buttons.",
    "Platforms > Facebook > Content shows optional properties only; the Global Default Image lives in Social Media > Open Graph.",
    "Platforms > Twitter > Cards uses dedicated Large Summary + Summary images; the optional dropdown does not include them.",
    "Open Graph Content offers an Additional Aspect Ratios dropdown that mirrors the Global patterns (plus to add, left-aligned minus to remove, inline labels, Select/Clear controls, and previews for each aspect).",
    "Global Default Image help includes specs: 1.91:1 aspect ratio, 1200x630 resolution, JPEG or PNG formats.",
    "Open Graph Content includes the square 1:1 (1200x1200) image as its own field; the dropdown lists 1.91:1 and 1:1 as disabled items for clarity.",
    "Social Media > Open Graph hosts the Global Defaults block; the Social Dashboard does not include global default image controls.",
    "Platforms > Twitter > Cards includes an Alternate Twitter Card image field alongside the primary default image.",
    "Platforms > Twitter > Cards includes Optional Properties and Images sections; Images holds the default and alternate Twitter card images (no aspect-ratio variants).",
    "Platforms > Twitter > Cards labels the default/alternate images as Summary Large and Summary; Additional Aspect Ratios are not present on that tab.",
    "Platforms > Instagram/TikTok/LinkedIn panels are placeholders with a single overview/description section.",
    "Save Social Settings button appears at the bottom of the Social Media form, beneath the tab panels.",
    "Platforms > Twitter > Overview contains the status pill; no separate Status section/subtab is shown.",
    "Platforms > Facebook > Overview contains the status pill; no separate Status section/subtab is shown.",
    "Platforms > Twitter > Tools includes a Twitter-only dry-run toggle that skips outputting Twitter meta tags while computing values.",
    "Platforms > Facebook > Tools includes the OpenGraph-only dry-run toggle.",
    "Social Dashboard does not show the OpenGraph dry-run toggle; it lives under Platforms > Facebook > Tools.",
    "Schema > Dashboard includes Operation, Individual Schema, and Schema Health Check sections; Defaults replaces the Settings label; Options hosts Image validation; Debug hosts debug and dry-run toggles.",
    "Schema Tests live under Analyser; Schema Dashboard remains available for Operation/Individual Schema/Health Check.",
    "Analyser > Schema Tests adds browser profile selection per output column and adds spacing above the Diff panel.",
    "Analyser > Schema Tests JSON-LD view pretty-prints the JSON-LD blocks for readability.",
    "Selector box uses a two-row flex layout; the Analyser selector background matches the Schema Global Identity box while the Local toggle box matches the Overview tab background.",
    "Selector box supports the include-posts toggle with Max Posts and a full-height Local column spanning both rows.",
    "Analyser > Overview selector uses Local/Remote radio buttons instead of a single Local checkbox.",
    "Analyser > Overview Local/Remote radios stack vertically within the Local box.",
    "Analyser > Overview Local box aligns its radios to the top and bottom of the two selector rows.",
    "Social validator lives under Analyser > Social Tests.",
    "Analyser > Overview controls include a List Pages button with Max Site Pages, and the follow-links limit sits to the right of Run Analysis with a Max Follow Links label.",
    "Analyser > Overview enables List Pages/Max Site Pages for Websites or when a manual URL matches the homepage (scheme-agnostic). Run Analysis/Max Follow Links are enabled for manual non-homepage URLs; homepage targets require a successful List Pages before Run Analysis is enabled.",
    "Analyser > Overview provides a Subpage(s) dropdown populated via sitemap discovery (robots.txt or common sitemap locations) when List Pages is clicked, and enables Run Analysis/Max Follow Links after the list finishes loading.",
    "Analyser > Overview list controls are back on a single row inside the box (List Pages, Subpage(s), Max Site Pages).",
    "Analyser > Overview includes a Local/Remote radio column with a vertical divider before the Websites/Manual radio group.",
    "Analyser > Overview Local toggle sends a local flag and maps analyser/list pages requests to the local site base.",
    "Analyser > Overview labels the selector box with a \"Selector\" heading.",
    "Schema > Preview Target uses the Selector box pattern (Local toggle, Websites/Manual URL, List Pages, Subpage(s), Max Site Pages) and omits the Use Homepage shortcut.",
    "Image Selection Summary panels are not used in the current Social UI.",
    "Analyser > Schema Tests Render Criteria shares one row with the Create/Refresh/Clear actions, uses vertical dividers between Capture/View/Colour/Add BE SEO, and derives Local vs Remote from the Selector (Render Location controls are not present).",
    "Analyser > Social Tests uses the shared Selector box pattern (Local/Remote, Websites/Manual URL, List Pages, Subpage(s), Max Site Pages, Include Posts/Max Posts).",
    "Schema preview columns keep a minimum height (240px) to maintain layout stability.",
    "Playfair capture lives under Analyser > Playfair with schema, Open Graph, and Twitter outputs.",
    "Sitemap page includes a status pill with last generated time and links to /sitemap.xml, /sitemap_index.xml, and the latest sitemap file; the success notice also shows the friendly /sitemap_index.xml link. Sitemap sections use tabs with Dashboard (status + preview/generate), Inclusion, Crawl Hints, Notifications, and External Links. Preview mode toggle always shows XML/HTML radios and disables the unavailable format. Dashboard contains a two-column status + preview/generate box (preview/generate on the left), a Generation Results box, and a Preview Results box; Generation Results uses a custom boxed summary instead of a WP notice stripe. Preview Results shows pretty-printed, color-coded XML/HTML code blocks side-by-side when both are present, with matched heights; a single preview keeps a minimum height."
  ],
  "ui_rules": [
    "Use the \"Selector\" box pattern (as in Analyser > Overview) whenever a user must select a web page."
  ],
  "logic_notes": [
    "Social engine honors the per-network enable toggles: Open Graph output depends on social_enable_og, Twitter Cards on social_enable_twitter, and both keys have defaults to avoid notices on fresh installs.",
    "The master social enable flag mirrors the per-network toggles so Open Graph/Twitter output does not stop early when the legacy master flag is unset.",
    "Schema engine respects BE_SCHEMA_DISABLE_ALL, BE_SCHEMA_DISABLE_ELEMENTOR, and BE_SCHEMA_DEBUG when set in wp-config.php.",
    "Sitemap alias runs early on template_redirect so /sitemap.xml is served before canonical redirects.",
    "Sitemap discovery validates candidate XML before accepting a sitemap URL to avoid HTML fallbacks.",
    "Playfair local captures force http for local/private hosts to avoid invalid HTTPS cert errors.",
    "Preview requests bypass canonical redirects to keep local Playfair captures on http."
  ],
  "refactor_notes": [
    "Centralized social settings defaults/merging into includes/engine/core-social-settings.php; core-social.php and the admin save share a single source of truth for default keys and merges.",
    "Added a shared optional-field helper script (includes/admin/js/be-optional-fields.js) and wired Social admin dropdowns (Facebook/Twitter and image variants) to it to remove duplicated JS.",
    "Introduced a shared image validation toggle (default on) and began moving image status checks behind a reusable helper; Schema Options expose the Image validation toggle.",
    "Schema optional dropdowns use the shared optional-field helper with proper scopes/hidden/singleton metadata across Person, WebSite images, Organisation, and Publisher panels.",
    "Added shared admin helpers for URL validation and validator target lists; schema/social delegate to them.",
    "Added shared selector utilities (includes/admin/js/be-selector.js) to reuse list-pages/selector logic across analyser, schema preview, and validator.",
    "Removed inline validator CSS/JS from the Analyser page to rely on the shared validator partials.",
    "Shared Playfair capture partials power Analyser > Playfair.",
    "Fixed Schema Tests preview template after moving it into Analyser.",
    "Removed Schema Tests Playfair include after moving captures to Analyser.",
    "Added shared admin UI helpers (tabs/sections/status pills) plus admin-ui.css so sitemap/tools/schema reuse common layout styling.",
    "Moved Sitemap inline scripts into assets/js/sitemap-admin.js and localized runtime data for the admin UI.",
    "Standardized tester panels in page-tools.php with shared wrapper + selector helpers for Schema, Social, Playfair, and Analyser tabs.",
    "Normalized Analyser/Playfair naming in UI strings and comments to avoid legacy Tools/Wayfair drift.",
    "Aligned CHANGELOG terminology with Analyser/Playfair and Schema/Social Tests naming to reduce documentation drift.",
    "Split Social Media tab layouts into partials for Open Graph, Platforms, Facebook, and Twitter with shared optional-fields blocks.",
    "Removed the Analyser Images tab and updated admin headers to the BE SEO naming.",
    "Fixed the validator inline script wrapper by removing a stray IIFE closer that caused a JS parser error."
  ],
  "ui_notes_tools": [
    "Analyser submenu has Schema Tests, Social Tests, Playfair, and Analyser tabs with a shared selector header; Analyser hosts its Overview/Issues/Pages/History/Settings subtabs. Tabs use WP nav-tab styling with inline CSS/JS fallback to ensure visibility.",
    "Analyser > Schema Tests panel omits the heading/description so the preview content starts immediately.",
    "Analyser Render Criteria shows a divider between Add BE SEO and the action buttons (Create/Refresh/Clear), styled via .be-schema-preview-criteria-divider.",
    "Analyser > Playfair focuses on capture output only (settings summary removed).",
    "Analyser/Schema admin pages force the WP footer to flow normally and add extra bottom padding via admin-ui.css to prevent overlap with preview output.",
    "Analyser is accessed via its own submenu entry; within the page, tabs switch panels via JS on nav-tab links.",
    "Analyser appears above Settings in the admin submenu order.",
    "Admin pages add extra bottom padding on Analyser/Schema screens to avoid the WP footer overlapping preview output."
  ],
  "text_tone_notes": [
    "Removed the leading \"Optional.\" prefix from optional-field helper text across Schema UI for cleaner phrasing.",
    "Person profile image helper text follows the standard aspect-ratio guidance with status pills (Undefined/Verified/Resolution).",
    "Social Media > Facebook Content contains Optional Properties (page URL, app ID, notes); image defaults live under Open Graph."
  ],
  "ux_notes_identity": [
    "Site Identity publisher option is only available when WebSite.publisher is enabled on the Publisher tab (dedicated publisher optional); identity radio/tab automatically disable when publisher is off. Publisher tab itself remains accessible so you can turn it on."
  ],
  "testing_notes": [
    "Manual test checklist in tests/README.md covering schema/social URL validation, dry-run behaviour, and debug readiness pills. No automated test suite wired up yet."
  ],
  "safety_notes": [
    "Schema: dry-run toggle lives under Schema > Debug, preventing JSON-LD output while logging BE_SCHEMA_DRY_RUN events.",
    "Social: dry-run toggles live under Platforms > Facebook Tools (OpenGraph) and Platforms > Twitter Tools (Twitter), preventing output while logging BE_SOCIAL_DRY_RUN events."
  ],
  "ux_notes_settings": [
    "Schema > Dashboard uses Operation/Individual Schema/Schema Health Check panels (no Debug & Safety block on that tab).",
    "Schema > Debug tab hosts the Debug logging and Dry run toggles; Options includes Image validation.",
    "Schema > Dashboard does not show a WordPress subtab; debug warnings only appear under Debug.",
    "Settings > Help Text uses two Global-style boxes (Existing, Add New Override) with a disclosure triangle, plus/minus row controls, and a live override count; Existing is collapsed by default and shows the count when collapsed.",
    "Help Text override validation only accepts help/descriptive strings sourced from description-class helper text (labels are ignored).",
    "Settings > Lists tab hosts the Websites list used by Analyser; Analyser settings points users to Settings \u2192 Lists.",
    "Settings > Lists uses Global-style boxes for Websites and Library; the saved website list renders in Websites while the Library box hosts the entry row.",
    "Settings > Lists action buttons (Save/Local/Remote) use delegated click handling so they respond even when panels are toggled.",
    "Settings > Lists Library shows a divider above the status message only when a status/error is present.",
    "Settings > Lists URL checks return readable errors from admin-ajax and allow local targets when Local is selected or Local File Access is enabled.",
    "Settings > Lists local checks skip URL remapping when the target is already local (localhost/.local/private IP).",
    "Settings > Lists local checks fall back to the current site base when the Playfair local base looks like a Playfair endpoint (host.docker.internal/port 3719).",
    "Library row order is Save Website, URL, Label, then Local/Remote checks. Saved sites render in the Websites box with the same controls plus a per-site Auto-check toggle. Local/Remote checks probe reachability via admin AJAX and store status per site.",
    "Settings > Playfair tab hosts Playfair configuration; Local File Access toggle controls private/localhost capture allowance.",
    "Analyser/Settings tabs use JS-driven data-tools-tab toggling (nav-tab styling only; no hash updates)."
  ],
  "debug_notes": [
    "Schema/Social debug logging emits BE_SCHEMA_DEBUG_GRAPH and BE_SOCIAL_DEBUG entries to error_log when WP_DEBUG + Debug are on."
  ],
  "dev_workflow_notes": [
    "Home hero panel lists dev workflow reminders: pre-commit auto bump + auto message, use dry-run toggles for testing, check tests/README.md, keep beseo-devnotes.json updated.",
    "Changelog entries include a generated Summary, a Description (neutral unless BESEO_CHANGELOG_DESC is set), and a Details list (from staged files or BESEO_COMMIT_MSG).",
    "Prepare-commit-msg hook appends the first few staged files to the autogenerated title (unless BESEO_COMMIT_MSG is set) to keep commit subjects more descriptive.",
    "Fixed stray PHP endif in the social platforms layout after moving Global Defaults into the Open Graph Content tab."
  ]
}