# BE SEO Engine – Development Notes

## Author: Bill Evans, PhD
### Plugin: BE Schema Engine
### Purpose: Central, conservative, and controllable schema + social meta for WordPress (Elementor-first), with strong safety and debug tools.

-------------------------------------------------------------------------------
## Section I: How ChatGPT Uses This File
-------------------------------------------------------------------------------

### Overview:
This file is the authoritative reference for the **BE Schema Engine** development project. It enables ChatGPT to understand the plugin's architecture, functionality, and directory structure, and facilitates its role in suggesting or applying code changes. 

### Key Directives for ChatGPT:
1. **Codebase Knowledge**:
   - ChatGPT refers to this file before suggesting or applying any code changes.
   - Any structural or functional change to the project should result in an update to this file.

2. **Commit Log File**:
   - ChatGPT must examine the **commit log** (`BE_SEO-Commit_Log.json`) after every push to keep its knowledge synchronized with the codebase. 
   - The log contains a history of all code commits, the files changed in each commit, and other metadata.
   - Always access the log from this URL: 
     [https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/BE_SEO-Commit_Log.json]

3. **File Access Using URLs**:
   - Every source file is listed in the **Directory Structure** below, along with its corresponding raw GitHub URL (in square brackets).
   - Use these URLs to fetch the latest versions of files when needed.

4. **Workflow and Updates**:
   - When ChatGPT suggests any code or architectural change, it must provide an updated version of this file if the change affects:
     - Architecture or functionality.
     - The directory structure.
     - File organization or URLs.
   - The `BE_SEO-Commit_Log.js` should be checked after each push to verify modifications.

5. **Pushed Changes**:
   - After user confirms "Pushed":
     - Cross-check the actual changes in `BE_SEO-Commit_Log.js` against what was suggested.
     - Access the updated files and adjust knowledge as needed.

6. **Debugging Assistance**:
   - Use the information in this file to support debugging by maintaining an understanding of the plugin’s structure, safety mechanisms, and integration points.

### File Naming and Availability:
1. **Development Notes File**:
  - Name: `BE_SEO-Dev_Notes.txt`
  - Available at: [https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/BE_SEO-Dev_Notes.txt]

2. **Commit Log File**:
  - Name: `BE_SEO-Commit_Log.js`
  - Available at: [https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/BE_SEO-Commit_Log.js]

### Workflows:
#### Log Push Activity as JSON:
Whenever a push is made to the `origin` repository, GitHub Actions automatically updates the commit log (`BE_SEO-Commit_Log.js`). The action’s steps are as follows:
1. Check if the log file exists; otherwise, initialize it as an empty JSON array.
2. Append detailed information about the latest push, including:
   - Timestamp.
   - Branch name.
   - Commit message.
   - Author information.
   - A list of added, modified, or deleted files.
3. Push the updated log file back to the repository.

-------------------------------------------------------------------------------
## Section II: How to Read the Commit Log File
-------------------------------------------------------------------------------

### Overview:
The `BE_SEO-Commit_Log.js` file contains a historical log of all codebase changes, detailing each commit that was made to the repository. Each entry in the file records metadata about the commit, such as the timestamp, branch, commit message, files affected, and the status of each file. This section explains how ChatGPT can parse and use this JSON data to verify changes and update its knowledge of the codebase.

### JSON Schema:
The `BE_SEO-Commit_Log.js` file is structured as a JSON array, where each object in the array represents a single commit. The log file may grow indefinitely, maintaining a record of every push. Below is the structure of each JSON object:

#### Top-Level Fields:
- **`timestamp` (string)**:
  - The ISO-8601 timestamp (`YYYY-MM-DDTHH:mm:ssZ`) indicating when the commit was pushed.
  - Example: `"2025-12-06T14:32:00Z"`

- **`branch` (string)**:
  - The Git branch where the changes were pushed. This field uses the full branch reference (`refs/heads/branch-name`).
  - Example: `"refs/heads/main"`

- **`commit_message` (string)**:
  - The message provided by the user describing the commit.
  - Example: `"Added new functionality for site-level schema"`

- **`commit_author` (string)**:
  - The name of the user who authored the commit.
  - Example: `"Bill Evans"`

- **`files_changed` (array)**:
  - A list of objects that detail every file affected in the commit. Each object represents a single file.

#### Nested Fields in `files_changed`:
Each object in the `files_changed` array has the following attributes:
- **`file` (string)**:
  - The relative path of the file modified during the commit. The path is relative to the repository root.
  - Example: `"includes/engine/core-site-entities.php"`

- **`status` (string)**:
  - The status of the file in this commit. Possible values:
    - `"A"`: File was added.
    - `"M"`: File was modified.
    - `"D"`: File was deleted.
  - Example: `"M"`

### Example Entry:
Here is an example of a single commit entry from the `BE_SEO-Commit_Log.js` file:
```json
{
  "timestamp": "2025-12-06T14:32:00Z",
  "branch": "refs/heads/main",
  "commit_message": "Fixed bug in breadcrumb schema",
  "commit_author": "Bill Evans",
  "files_changed": [
    {
      "file": "includes/engine/core-breadcrumbs.php",
      "status": "M"
    },
    {
      "file": "README.md",
      "status": "A"
    },
    {
      "file": "old_code/legacy-config.php",
      "status": "D"
    }
  ]
}
```

### How to Parse and Use the Data:
1. **Locate the Log File**:
   - Always use the GitHub Raw URL to fetch the latest version of the log:
     [https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/BE_SEO-Commit_Log.js]

2. **Iterate Through the Entries**:
   - Each object in the top-level JSON array represents a commit. Start by parsing the file as an array, then iterate over each commit object.

3. **Key Insights Per Commit**:
   - **Determine What Changed**: Iterate through the `files_changed` array to access each `file` and its `status`.
   - **Verify Commit Message**: Use `commit_message` to understand the purpose of the commit.
   - **Identify Branch**: Use `branch` to confirm where the changes were made.

4. **Actionable Updates for ChatGPT**:
   - Use the `files_changed` field to download the latest version of modified (or added) files listed in this commit.
   - For deleted files (`status = "D"`), remove the corresponding file from ChatGPT's knowledge of the codebase.

5. **Validate Against Expectations**:
   - Compare the `files_changed` and commit metadata with the changes ChatGPT previously suggested.
   - If discrepancies arise (e.g., unexpected edits or unwarranted deletions), seek clarification from the user.

### Applications:
- **Synchronize Knowledge**:
  - Always use the latest entries from the log to stay up-to-date with the codebase.
- **Trace Changes Over Time**:
  - Older entries can help establish a history of changes to a particular file or functionality.
- **Detect Significant Updates**:
  - Monitor commits with large numbers of file changes or impactful commit messages (e.g., "Refactor entire module") and adjust architectural understanding accordingly.

-------------------------------------------------------------------------------
## Section III: Directory Structure
-------------------------------------------------------------------------------

be-schema-engine.php  		[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/be-schema-engine.php]					// main plugin bootstrap (now "BE SEO" in WP UI)

/includes/admin/	
    admin-menu.php			[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/admin/admin-menu.php]
    page-dashboard.php		[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/admin/page-dashboard.php]
    page-schema.php			[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/admin/page-schema.php]			// "Schema" submenu
    page-social-media.php	[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/admin/page-social-media.php] 	// "Social Media" submenu
    page-tools.php			[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/admin/page-tools.php]			// "Tools" submenu

/includes/engine/
    core-breadcrumbs.php	[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-breadcrumbs.php]	// BreadcrumbList for non-front pages
    core-debug.php			[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-debug.php]			// debug collector + shutdown logger
    core-elementor.php		[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-elementor.php]		// Elementor integration
    core-helpers.php		[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-helpers.php]		// text/image helpers
    core-posts.php			[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-posts.php]			// BlogPosting schema
    core-site-entities.php	[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-site-entities.php]	// Site-level entities
    core-social.php			[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-social.php]			// OpenGraph + Twitter Cards
    core-special-pages.php	[https://raw.githubusercontent.com/realnotsteve/beseo/refs/heads/main/be-schema-engine/includes/engine/core-special-pages.php]	// Special page schema

--------------------------------------------------
IV: High-level goals
--------------------------------------------------

- Provide a single, safe source of JSON-LD schema for:
  - Site-level entities: Person, Organisation, WebSite, Publisher, shared Logo.
  - Page-level special pages: Home, Contact, About, Privacy Policy, Accessibility Statement.
  - Blog posts: BlogPosting.
  - Breadcrumbs.
  - Elementor-driven widgets (image, etc.) – currently pared back to core/safe widgets only.

- Provide a central place to manage:
  - OpenGraph tags (og:*) for social sharing and Facebook.
  - Twitter Card meta (twitter:*) for Twitter/X.

- Safety & control:
  - Safe-by-default: schema is opt-in at the page level (Elementor controls).
  - Per-page disable meta box.
  - Global kill switches via constants.
  - Debug tools write to error_log, not to the front-end.

- Integration:
  - Elementor: page settings and (limited) widget-level controls.
  - Admin: dedicated menu with subpages for Schema, Social Media, Tools, etc.
  - Debug: structured JSON snapshots for both schema and social.


--------------------------------------------------
V: File layout / Includes
--------------------------------------------------

Includes:
- includes/core-site-entities.php
  - Builds site-level model: Person, Person image, Organisation, WebSite, Publisher, Publisher logo, shared Logo.
  - Returns both:
    - A structured array model (`be_schema_get_site_entities()`).
    - A flat list of nodes for @graph (`be_schema_get_site_entity_graph_nodes()`).
  - Person:
    - Uses site name by default.
    - Image: Person profile image (#person-image) or fallback #logo.
    - HonorificPrefix/honorificSuffix from admin.
    - Person-specific sameAs from textarea (one URL per line).
  - Organisation:
    - Name, legalName, URL, logo (#logo).
    - sameAs via `be_schema_sameas_urls` filter (Org-only).
  - WebSite:
    - Always present (#website).
    - about → Organisation if present; otherwise Person.
    - logo → #logo if present.
    - publisher → custom publisher / Organisation / Person.
  - Publisher:
    - Optional, controlled by admin setting.
    - Either:
      - Custom Organisation (#publisher + #publisher-logo), or
      - Fallback to Organisation/Person by @id.

- includes/core-helpers.php
  - Shared helpers:
    - `be_schema_normalize_text()` – strip HTML, collapse whitespace, truncate cleanly.
    - `be_schema_normalize_image()` – accept URL/string/array and return clean URL array.
    - `be_schema_get_default_image_url()` – fallback image logic (theme image or site icon).
  - Post-type eligibility:
    - `be_schema_is_singular_eligible()` – filterable helper for which post types can emit schema.
  - Per-page checks:
    - `be_schema_is_disabled_for_current_page()` – reads meta + Elementor page settings.

- includes/core-debug.php
  - Debug collector:
    - `be_schema_debug_collect( $node_or_nodes )` – collects JSON-LD nodes into a shared buffer.
  - Shutdown logger:
    - On shutdown, if WP_DEBUG + BE_SCHEMA_DEBUG (or plugin debug setting) are true, logs:
      - `BE_SCHEMA_DEBUG_GRAPH: { "@graph": [...] }` to error_log.
  - Used by page schema, blog posts, Elementor schema, etc.

- includes/core-special-pages.php
  - Page-level schema (home/contact/about/privacy/accessibility).
  - Home:
    - `be_add_homepage_schema()` – emits @graph of Person, Organisation, WebSite, WebPage.
  - Contact/About/Privacy/Accessibility:
    - Reads Elementor page type (contact, about, privacy-policy, accessibility-statement).
    - Emits a single JSON-LD object per page (ContactPage, AboutPage, etc.).
    - Uses sensible default descriptions when no override exists.
  - Respects:
    - Global disable.
    - Per-page disable.
    - Elementor page-level enable/disable.

- includes/core-posts.php
  - `be_add_post_schema()` – BlogPosting schema for single posts.
  - Only runs when:
    - Global not disabled.
    - `is_singular( 'post' )`.
    - Post type allowed by `be_schema_is_singular_eligible()`.
    - Current page not disabled by Elementor/meta.
  - BlogPosting:
    - @id = post_permalink#article.
    - mainEntityOfPage WebPage node.
    - description = excerpt or normalized content snippet.
    - datePublished / dateModified (c format).
    - author → Person#person.
    - publisher → Organisation#organization or Publisher entity.
    - image:
      - Featured image, or default image via `be_schema_get_default_image_url()`.

- includes/core-breadcrumbs.php
  - `be_add_breadcrumb_schema()` – simple BreadcrumbList.
  - Skips:
    - Global disabled.
    - Per-page disabled.
    - Front page.
  - Always two items:
    - Position 1: site root.
    - Position 2: current page / archive.
  - Cleans URLs:
    - Strips utm_*, gclid, fbclid.

- includes/engine/core-elementor.php
  - Elementor integration (page settings + limited widget schema).
  - Adds:
    - Page Settings → Advanced → “Schema” panel:
      - `be_schema_enable_page` (switcher).
      - `be_schema_page_type` (contact/about/privacy/accessibility/none).
      - Optional per-page description override (and previously image override when enabled).
    - Widget-level control (Advanced):
      - `be_schema_enable_widget` (switcher).
  - Output logic:
    - `output_elementor_schema()` on wp_head priority 20.
    - Skips admin/AJAX/REST/non-suitable contexts.
    - Requires:
      - Elementor available and document loaded.
      - Post type eligible.
      - Page-level schema allowed.
    - Traverses document tree and emits schema for a small, controlled set of widget types (currently the safe core set only).
    - All Elementor nodes collected into a per-page @graph.

- includes/engine/core-social.php
  - Front-end engine for OpenGraph and Twitter Cards.
  - Functions:
    - `be_schema_social_get_settings()` → reads `be_schema_social_settings` option with defaults.
    - `be_schema_social_clean_url()` → strips tracking params (utm_*, gclid, fbclid) and fragments from URLs.
    - `be_schema_social_debug_enabled()` → follows main debug model (WP_DEBUG + plugin debug or BE_SCHEMA_DEBUG).
    - `be_schema_output_social_meta()`:
      - Bails in admin / feeds / robots / embeds / AJAX / REST.
      - Reads Social Media settings.
      - If OG and Twitter are both disabled, outputs nothing.
      - Resolves URL via `wp_get_canonical_url()` or permalink, then cleans it.
      - Title from `wp_get_document_title()`.
      - Description from post excerpt/content or site tagline, normalized via `be_schema_normalize_text()` when available.
      - Image selection:
        - Featured image if present.
        - For OG: Facebook default image → global default image.
        - For Twitter: Twitter default image → global default image.
      - OG:
        - `og:title`, `og:description`, `og:type` (article for posts, website otherwise), `og:url`, `og:site_name`, `og:image`.
        - For posts: `article:published_time`, `article:modified_time`, `article:author`.
        - Optional `fb:app_id` when set.
      - Twitter:
        - `twitter:card` (summary or summary_large_image).
        - `twitter:title`, `twitter:description`, `twitter:image`.
        - `twitter:site` and `twitter:creator` from handle (with @ prefix).
      - When debug is enabled, logs a JSON snapshot to `error_log` with prefix `BE_SOCIAL_DEBUG:`.

Admin:
- includes/admin/page-schema.php
  - Renders “BE Schema Engine → Schema” submenu page.
  - Two top-level tabs:
    - Settings
      - Global toggles: enable plugin, enable Elementor schema, debug flag.
      - Diagnostics summary: effective status of globals + constants.
      - Snapshot table of saved settings (read-only).
    - Website
      - Left vertical nav: Global / Person / Organisation / Publisher.
      - Global tab:
        - Shared site logo (#logo) — used by WebSite, Organisation, Person fallback.
        - Three WebSite featured images (16:9, 4:3, 1:1) with media pickers.
      - Person tab:
        - Enable Person entity.
        - Profile picture URL (media picker).
        - Honorific prefix/suffix.
        - Person sameAs URLs (textarea, one per line).
      - Organisation tab:
        - Enable Organisation entity.
        - Org name, legal name, URL.
        - Read-only view of shared logo (#logo).
      - Publisher tab:
        - Enable WebSite.publisher.
        - Basic publishing fields: copyright year, license URL, publishing principles, corrections policy, ownership/funding URL.
        - Option to use custom publisher organisation:
          - Custom publisher name, URL, logo (#publisher-logo).
  - Handles saving of all admin settings to `be_schema_engine_settings` option.
  - Enqueues media library for image pickers.
  - Contains JS for:
    - Top-level tabs (Settings/Website).
    - Vertical nav (Global/Person/Organisation/Publisher).
    - Show/hide fields based on Person/Organisation/Publisher checkboxes.
    - Media selection & clear for all image URL fields.

- includes/admin/page-social-media.php
  - Renders “BE Schema Engine → Social Media” submenu page.
  - Three tabs: Settings / Facebook / Twitter.
  - Stores all values in `be_schema_social_settings` option.
  - Settings tab:
    - Enable OpenGraph tags (checkbox).
    - Enable Twitter Cards (checkbox).
    - Global default fallback image (media picker) for OG/Twitter when no featured or network-specific image exists.
  - Facebook tab:
    - Facebook Page URL.
    - Default Facebook OG image (media picker) used when no featured image exists.
    - Facebook App ID (optional).
    - Notes (admin-only text, never output).
  - Twitter tab:
    - Twitter handle (without @).
    - Default card type (summary / summary_large_image).
    - Default Twitter card image (media picker).
    - Notes (admin-only text, never output).
  - Enqueues media library and JS to:
    - Handle tab switching.
    - Integrate media pickers for all image fields.
    - Clear and preview selected images.


--------------------------------------------------
VI: Schema design rules (high-level)
--------------------------------------------------

Site-level entities:
- Person:
  - Represents the primary individual associated with the site.
  - Name defaults to site name (can be clarified in UI).
  - Image: person profile image if defined; otherwise fallback to shared #logo.
  - sameAs:
    - Populated only from Person textarea (one URL per line).
    - No automatic sameAs from Social Media module.

- Organisation:
  - Optional but recommended for business sites.
  - Logo → shared #logo.
  - sameAs:
    - Populated via `be_schema_sameas_urls` filter (Org-only).
    - Admin UI does not manage Org sameAs directly (keeps things simple and pluggable).

- WebSite:
  - Always present.
  - about:
    - Points to Organisation if enabled; otherwise Person.
  - logo:
    - Points to shared #logo when defined.
  - publisher:
    - Configurable:
      - Custom Publisher organisation.
      - Organisation.
      - Person.

- Publisher:
  - Optional entity for WebSite.publisher.
  - When a custom publisher is enabled:
    - Distinct Organisation with its own logo (#publisher-logo).
  - Otherwise, WebSite.publisher falls back to Organisation/Person by @id.

Page-level schema:
- Homepage:
  - @graph:
    - Person, Organisation, WebSite, WebPage.
  - WebPage:
    - isPartOf → WebSite.
    - about → Person or Organisation.
    - primaryImageOfPage → featured image or shared logo when available.

- Contact/About/Privacy/Accessibility:
  - Single node per page:
    - ContactPage, AboutPage, PrivacyPolicy, WebPage (for accessibility statement).
  - Description:
    - Uses Elementor override text when provided, otherwise a default “This is the contact page…” style string.
  - Respects:
    - Global disable.
    - Per-page disable.
    - Elementor page-level enable/disable.

Blog posts (BlogPosting):
- Only for `is_singular( 'post' )` and eligible post types.
- Title from post title.
- Description:
  - Excerpt if available.
  - Otherwise first ~300 chars of content, normalized via `be_schema_normalize_text()`.
- Dates:
  - datePublished = get_post_time('c').
  - dateModified = get_post_modified_time('c').
- mainEntityOfPage:
  - WebPage node with @id = post permalink.
- author:
  - Person#person (site-level Person).
- publisher:
  - Configured Publisher/Organisation/Person from site entities.
- image:
  - Featured image, else default image via `be_schema_get_default_image_url()`.

Breadcrumbs:
- Always two steps:
  - Root (site URL).
  - Current page/archive.
- Filters URLs:
  - Strips utm_*, gclid, fbclid.
- Skips:
  - Front page.
  - Pages marked as schema-disabled.

Elementor:
- Page-level:
  - `be_schema_enable_page`:
    - "yes" = schema allowed (subject to other checks).
    - Missing or any other value = treat as disabled (safe default).
  - `be_schema_page_type`:
    - Maps to special page schema types (ContactPage, AboutPage, etc.).
- Widget-level:
  - `be_schema_enable_widget` switcher:
    - Only when "yes" does the widget even consider emitting schema.
  - Only a curated list of widgets have schema logic; plugin avoids blanket “schema for everything.”

Social / OpenGraph & Twitter:
- Purpose:
  - Social Media module is only for OpenGraph and Twitter Cards.
  - It does NOT:
    - Create or modify JSON-LD schema.
    - Populate Person/Organisation sameAs arrays.
    - Emit canonical tags.

- Data flow:
  - Admin UI (includes/admin/page-social-media.php) writes to `be_schema_social_settings`.
  - Front-end engine (includes/engine/core-social.php) reads these settings to decide:
    - Whether to emit og:* tags.
    - Whether to emit twitter:* tags.
    - Which title, description, URL, and image to use.

- Behavior:
  - URL:
    - Uses `wp_get_canonical_url()` when available; falls back to permalink or home URL.
    - Cleaned via `be_schema_social_clean_url()`:
      - Removes utm_*, gclid, fbclid.
      - Strips URL fragments (#...).
  - Title:
    - Uses `wp_get_document_title()`.
  - Description:
    - For singular posts/pages: excerpt or post_content.
    - Otherwise: site tagline.
    - Normalized via `be_schema_normalize_text()` when available (strip HTML, collapse whitespace, truncate nicely).
  - Images:
    - OG and Twitter choose images independently but follow similar rules:
      - Prefer featured image when available.
      - For OG:
        - Use Facebook default image if set.
        - Else global default image.
      - For Twitter:
        - Use Twitter default image if set.
        - Else global default image.

- OG (OpenGraph):
  - `og:title`, `og:description`, `og:type`:
    - `article` for single posts.
    - `website` otherwise.
  - `og:url`:
    - Cleaned canonical/permalink.
  - `og:site_name`:
    - Blog name.
  - `og:image`:
    - Based on image rules above.
  - For posts:
    - `article:published_time`, `article:modified_time`, `article:author`.
  - Optional:
    - `fb:app_id` if set in Social Media → Facebook tab.

- Twitter:
  - `twitter:card`:
    - `summary_large_image` (default) or `summary`, from Social Media → Twitter tab.
  - `twitter:title`, `twitter:description`, `twitter:image`.
  - `twitter:site`, `twitter:creator`:
    - Derived from stored Twitter handle (with @ prefix).

- Debug:
  - Controlled by the same debug model as schema:
    - Requires `WP_DEBUG` true.
    - Respects `BE_SCHEMA_DEBUG` or plugin debug setting.
  - When enabled, `be_schema_output_social_meta()` logs a JSON snapshot to `error_log` with prefix:
    - `BE_SOCIAL_DEBUG: { ... }`
  - Snapshot includes:
    - URL, title, description, site_name.
    - OG/Twitter enable flags and resolved values (type, card_type, images, handle).
    - Chosen images: featured, global default, Facebook/Twitter defaults.


--------------------------------------------------
VII: Admin UX principles
--------------------------------------------------

- All destructive behavior (e.g., uninstall cleanup) is explicit and opt-in.
- All schema features are “off until clearly opted-in” at the page level:
  - Global plugin enabled.
  - Elementor page setting allows.
  - Page not explicitly disabled via meta box.
- Admin screens:
  - Schema:
    - Focus on site-level configuration + high-level toggles.
    - Keep advanced internals (like filters) documented in dev notes rather than UI.
  - Social Media:
    - Focus exclusively on OG/Twitter defaults and network-specific info.
    - No schema or sameAs configuration here.


--------------------------------------------------
VIII: Debug & safety
--------------------------------------------------

- Schema debug:
  - Controlled via:
    - `WP_DEBUG` + `BE_SCHEMA_DEBUG` OR plugin-level debug flag.
  - Uses `be_schema_debug_collect()` to accumulate nodes for the current request.
  - On shutdown, logs a single JSON payload:
    - `BE_SCHEMA_DEBUG_GRAPH: { "@graph": [ ... ] }`.

- Social debug:
  - `be_schema_social_debug_enabled()` follows the same rule as schema debug.
  - `be_schema_output_social_meta()` logs:
    - `BE_SOCIAL_DEBUG: { ... }` with:
      - Effective settings and resolved OG/Twitter values.

- Global kill-switch constants (in wp-config.php, optional):
  - `BE_SCHEMA_DISABLE_ALL`:
    - Disable all schema output from the plugin.
  - `BE_SCHEMA_DISABLE_ELEMENTOR`:
    - Disable Elementor-specific schema only.
  - These are optional overrides; admin UI still has its own enable/disable toggles.


--------------------------------------------------
IX: Versioning & packaging
--------------------------------------------------

- Plugin folder:
  - No longer includes version in the folder name.
  - Version number is managed via:
    - Plugin header.
    - Internal `BE_SCHEMA_ENGINE_VERSION` constant.

- When changing behavior that affects:
  - Output structure (schema graph).
  - Admin UI fields.
  - Social tags.
  - Debug behavior.

  → Increment plugin version and document changes in a separate changelog file or section.

--------------------------------------------------
X: Future ideas / parking lot
--------------------------------------------------

- Per-post OG/Twitter overrides:
  - Simple meta-box or Elementor control:
    - Custom OG/Twitter title/description/image.
  - All still go through the same Social engine for output.

- Additional social networks:
  - LinkedIn, Instagram, YouTube, etc.
  - Might remain OG-only, not schema, to avoid overloading Person/Org sameAs.

- Validator integration:
  - Optional “Tools” submenu page to:
    - Show quick links to external validators (Rich Results, OG debugger, Twitter Card validator).
    - Maybe echo back last debug snapshot for the current page.

- More granular Elementor widget schema:
  - Only after strong guardrails + opt-ins.
  - Consider making each widget type an explicit toggle in admin.